The proposed procedure would not work well for large numbers, which is the type of input we expect in our fast prime teser, because it takes the remainder only after the exponentiation is complete, which means that it deals with very large numbers until the last step and then takes the remainder of a large number.  The time complexity of arithmetic operations is determined by the size of the numbers in question. By contrast, as we have it in our implementation of expmod, the procedure takes the remainder at each step, which guarantees that it is always dealing with numbers as small as possible.

